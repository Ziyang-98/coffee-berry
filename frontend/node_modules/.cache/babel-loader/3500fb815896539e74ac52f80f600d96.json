{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\yang7\\\\OneDrive\\\\Documents\\\\GitHub\\\\coffeeberry\\\\frontend\\\\src\\\\Market\\\\Market.js\";\nimport React, { Component } from \"react\";\nimport Showcase from \"./Showcase/Showcase\";\nimport Searchbar from \"./Searchbar/Searchbar\";\nimport AddAYBar from \"./AddAY/AddAY\";\nimport Table from \"./PlannerTable/PlannerTable\";\nimport auth0Client from \"../Auth\";\nimport axios from \"axios\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ExportButton from \"./ExportPlanner/Export/ExportButton\";\nimport EditButtons from \"./ExportPlanner/Edit/EditButtons\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { withStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = theme => ({\n  alert: {\n    marginBottom: theme.spacing(2)\n  }\n});\n\nfunction Alert(props) {\n  return /*#__PURE__*/_jsxDEV(MuiAlert, {\n    elevation: 6,\n    variant: \"filled\",\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 10\n  }, this);\n}\n\n_c = Alert;\n\nclass Planner extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userData: null,\n      hasGuide: false,\n      degrees: null,\n      update: false,\n      exported: false\n    };\n    this.handleClose = this.handleClose.bind(this);\n  }\n\n  async componentDidMount() {\n    if (auth0Client.isAuthenticated() && this.state.userData === null) {\n      const username = auth0Client.getProfile().name;\n      await axios.post(`http://localhost:8081/Planner/name`, {\n        name: username\n      });\n      const degreesData = await axios.get(`http://localhost:8081/degrees`);\n      const degrees = degreesData.data.degrees;\n      const data = await axios.get(`http://localhost:8081/Planner/users/${username}`);\n      const userData = data.data; //this.setState({ userData, degrees });\n\n      let reviewData = await axios.get(`http://localhost:8081/editGuide/hasGuide/${username}`);\n      const hasReview = reviewData.data.hasReview;\n      this.setState({\n        userData,\n        degrees,\n        hasReview\n      }); // console.log(\"review gotten\");\n      // console.log(reviewData.data);\n    }\n  }\n\n  async componentDidUpdate() {\n    if (this.state.update) {\n      await this.refreshTable();\n      const update = false;\n      this.setState({\n        update\n      });\n    }\n  }\n\n  async submitAY(AY) {\n    const username = this.state.userData.name;\n    await axios.post(`http://localhost:8081/Planner/users/moduleList`, {\n      name: username,\n      AY: AY\n    });\n    const update = true;\n    this.setState({\n      update\n    });\n  }\n\n  async submitModule(year, semester, module) {\n    const username = this.state.userData.name;\n    await axios.post(`http://localhost:8081/Planner/users/${username}/`, {\n      AY: year,\n      semester: semester,\n      module: {\n        moduleCode: module.moduleCode,\n        moduleTitle: module.moduleTitle,\n        moduleCredits: parseInt(module.moduleCredits)\n      }\n    });\n    const update = true;\n    this.setState({\n      update\n    });\n  }\n\n  async exportPlanner(title, major, description, tags) {\n    const username = this.state.userData.name;\n    const moduleList = this.state.userData.moduleList;\n    await axios.post(`http://localhost:8081/reviews/${username}`, {\n      moduleList: moduleList,\n      title: title,\n      major: major,\n      description: description,\n      tags: tags\n    });\n    const update = true;\n    this.setState({\n      update\n    });\n    this.handleOpen();\n  } //Work in progress\n\n\n  async deleteYear(year) {\n    await axios.post(`http://localhost:8081/Planner/deleteYear`, {\n      name: this.state.userData.name,\n      AY: year\n    });\n    const update = true;\n    this.setState({\n      update\n    });\n  }\n\n  async deleteModule(year, semester, module) {\n    await axios.post(`http://localhost:8081/Planner/deleteModule`, {\n      name: this.state.userData.name,\n      AY: year,\n      semester: semester,\n      module: {\n        moduleCode: module.moduleCode,\n        moduleTitle: module.moduleTitle,\n        moduleCredits: parseInt(module.moduleCredits)\n      }\n    });\n    const update = true;\n    this.setState({\n      update\n    });\n  }\n\n  async refreshTable() {\n    const data = await axios.get(`http://localhost:8081/Planner/users/${this.state.userData.name}`);\n    const userData = data.data;\n    let reviewData = await axios.get(`http://localhost:8081/editGuide/hasGuide/${this.state.userData.name}`);\n    const hasReview = reviewData.data.hasReview;\n    this.setState({\n      userData,\n      hasReview\n    });\n  }\n\n  handleOpen() {\n    this.setState({\n      exported: true\n    });\n  }\n\n  handleClose() {\n    this.setState({\n      exported: false\n    });\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Showcase, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), auth0Client.isAuthenticated() && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [this.state.userData === null && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h4\",\n            children: \"Loading profile...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 15\n        }, this), this.state.userData !== null && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(AddAYBar, {\n            moduleList: this.state.userData.moduleList,\n            submitAY: this.submitAY.bind(this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Searchbar, {\n            submitModule: this.submitModule.bind(this),\n            userModuleList: this.state.userData.moduleList\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            moduleList: this.state.userData.moduleList,\n            deleteYear: this.deleteYear.bind(this),\n            deleteModule: this.deleteModule.bind(this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 17\n          }, this), !this.state.hasReview && /*#__PURE__*/_jsxDEV(ExportButton, {\n            exportPlanner: this.exportPlanner.bind(this),\n            degrees: this.state.degrees\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 19\n          }, this), this.state.hasReview && /*#__PURE__*/_jsxDEV(EditButtons, {\n            username: this.state.userData.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        open: this.state.exported,\n        autoHideDuration: 3000,\n        onClose: this.handleClose,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          className: classes.alert,\n          onClose: this.handleClose,\n          severity: \"success\",\n          children: \"Guide successfully exported!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default withStyles(useStyles)(Planner);\n\nvar _c;\n\n$RefreshReg$(_c, \"Alert\");","map":{"version":3,"sources":["C:/Users/yang7/OneDrive/Documents/GitHub/coffeeberry/frontend/src/Market/Market.js"],"names":["React","Component","Showcase","Searchbar","AddAYBar","Table","auth0Client","axios","Typography","ExportButton","EditButtons","Snackbar","MuiAlert","withStyles","useStyles","theme","alert","marginBottom","spacing","Alert","props","Planner","constructor","state","userData","hasGuide","degrees","update","exported","handleClose","bind","componentDidMount","isAuthenticated","username","getProfile","name","post","degreesData","get","data","reviewData","hasReview","setState","componentDidUpdate","refreshTable","submitAY","AY","submitModule","year","semester","module","moduleCode","moduleTitle","moduleCredits","parseInt","exportPlanner","title","major","description","tags","moduleList","handleOpen","deleteYear","deleteModule","render","classes"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Showcase from \"./Showcase/Showcase\";\r\nimport Searchbar from \"./Searchbar/Searchbar\";\r\nimport AddAYBar from \"./AddAY/AddAY\";\r\nimport Table from \"./PlannerTable/PlannerTable\";\r\nimport auth0Client from \"../Auth\";\r\nimport axios from \"axios\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport ExportButton from \"./ExportPlanner/Export/ExportButton\";\r\nimport EditButtons from \"./ExportPlanner/Edit/EditButtons\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = (theme) => ({\r\n  alert: {\r\n    marginBottom: theme.spacing(2),\r\n  },\r\n});\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nclass Planner extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      userData: null,\r\n      hasGuide: false,\r\n      degrees: null,\r\n      update: false,\r\n      exported: false,\r\n    };\r\n\r\n    this.handleClose = this.handleClose.bind(this);\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (auth0Client.isAuthenticated() && this.state.userData === null) {\r\n      const username = auth0Client.getProfile().name;\r\n      await axios.post(`http://localhost:8081/Planner/name`, {\r\n        name: username,\r\n      });\r\n\r\n      const degreesData = await axios.get(`http://localhost:8081/degrees`);\r\n      const degrees = degreesData.data.degrees;\r\n\r\n      const data = await axios.get(\r\n        `http://localhost:8081/Planner/users/${username}`\r\n      );\r\n      const userData = data.data;\r\n\r\n      //this.setState({ userData, degrees });\r\n\r\n      let reviewData = await axios.get(\r\n        `http://localhost:8081/editGuide/hasGuide/${username}`\r\n      );\r\n      const hasReview = reviewData.data.hasReview;\r\n      this.setState({ userData, degrees, hasReview });\r\n      // console.log(\"review gotten\");\r\n      // console.log(reviewData.data);\r\n    }\r\n  }\r\n\r\n  async componentDidUpdate() {\r\n    if (this.state.update) {\r\n      await this.refreshTable();\r\n      const update = false;\r\n      this.setState({ update });\r\n    }\r\n  }\r\n\r\n  async submitAY(AY) {\r\n    const username = this.state.userData.name;\r\n    await axios.post(`http://localhost:8081/Planner/users/moduleList`, {\r\n      name: username,\r\n      AY: AY,\r\n    });\r\n    const update = true;\r\n    this.setState({ update });\r\n  }\r\n\r\n  async submitModule(year, semester, module) {\r\n    const username = this.state.userData.name;\r\n    await axios.post(`http://localhost:8081/Planner/users/${username}/`, {\r\n      AY: year,\r\n      semester: semester,\r\n      module: {\r\n        moduleCode: module.moduleCode,\r\n        moduleTitle: module.moduleTitle,\r\n        moduleCredits: parseInt(module.moduleCredits),\r\n      },\r\n    });\r\n    const update = true;\r\n    this.setState({ update });\r\n  }\r\n\r\n  async exportPlanner(title, major, description, tags) {\r\n    const username = this.state.userData.name;\r\n    const moduleList = this.state.userData.moduleList;\r\n    await axios.post(`http://localhost:8081/reviews/${username}`, {\r\n      moduleList: moduleList,\r\n      title: title,\r\n      major: major,\r\n      description: description,\r\n      tags: tags,\r\n    });\r\n    const update = true;\r\n    this.setState({ update });\r\n    this.handleOpen();\r\n  }\r\n\r\n  //Work in progress\r\n  async deleteYear(year) {\r\n    await axios.post(`http://localhost:8081/Planner/deleteYear`, {\r\n      name: this.state.userData.name,\r\n      AY: year,\r\n    });\r\n    const update = true;\r\n    this.setState({ update });\r\n  }\r\n\r\n  async deleteModule(year, semester, module) {\r\n    await axios.post(`http://localhost:8081/Planner/deleteModule`, {\r\n      name: this.state.userData.name,\r\n      AY: year,\r\n      semester: semester,\r\n      module: {\r\n        moduleCode: module.moduleCode,\r\n        moduleTitle: module.moduleTitle,\r\n        moduleCredits: parseInt(module.moduleCredits),\r\n      },\r\n    });\r\n    const update = true;\r\n    this.setState({ update });\r\n  }\r\n\r\n  async refreshTable() {\r\n    const data = await axios.get(\r\n      `http://localhost:8081/Planner/users/${this.state.userData.name}`\r\n    );\r\n    const userData = data.data;\r\n\r\n    let reviewData = await axios.get(\r\n      `http://localhost:8081/editGuide/hasGuide/${this.state.userData.name}`\r\n    );\r\n    const hasReview = reviewData.data.hasReview;\r\n    this.setState({ userData, hasReview });\r\n  }\r\n\r\n  handleOpen() {\r\n    this.setState({ exported: true });\r\n  }\r\n\r\n  handleClose() {\r\n    this.setState({ exported: false });\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n    return (\r\n      <div>\r\n        <div>\r\n          <Showcase />\r\n        </div>\r\n        {auth0Client.isAuthenticated() && (\r\n          <div>\r\n            {this.state.userData === null && (\r\n              <div>\r\n                <Typography variant=\"h4\">Loading profile...</Typography>\r\n              </div>\r\n            )}\r\n            {this.state.userData !== null && (\r\n              <div>\r\n                <AddAYBar\r\n                  moduleList={this.state.userData.moduleList}\r\n                  submitAY={this.submitAY.bind(this)}\r\n                />\r\n                <Searchbar\r\n                  submitModule={this.submitModule.bind(this)}\r\n                  userModuleList={this.state.userData.moduleList}\r\n                />\r\n                <Table\r\n                  moduleList={this.state.userData.moduleList}\r\n                  deleteYear={this.deleteYear.bind(this)}\r\n                  deleteModule={this.deleteModule.bind(this)}\r\n                />\r\n                {!this.state.hasReview && (\r\n                  <ExportButton\r\n                    exportPlanner={this.exportPlanner.bind(this)}\r\n                    degrees={this.state.degrees}\r\n                  />\r\n                )}\r\n                {this.state.hasReview && (\r\n                  <EditButtons username={this.state.userData.name} />\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        <Snackbar\r\n          open={this.state.exported}\r\n          autoHideDuration={3000}\r\n          onClose={this.handleClose}\r\n        >\r\n          <Alert\r\n            className={classes.alert}\r\n            onClose={this.handleClose}\r\n            severity=\"success\"\r\n          >\r\n            Guide successfully exported!\r\n          </Alert>\r\n        </Snackbar>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(useStyles)(Planner);\r\n"]},"metadata":{},"sourceType":"module"}